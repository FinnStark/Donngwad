# 0) Nettoyer l’ancien patch
rm -f donngwad.patch

# 1) Créer le patch de correction (copie-colle tout ce bloc)
cat <<'EOF' > fix_parse_errors.patch
diff --git a/core/Game.gd b/core/Game.gd
--- a/core/Game.gd
+++ b/core/Game.gd
@@
-extends Node
-# class_name Game (retiré si présent)
-
-var speed := 1.0 # 0,1,2,3 (0 = pause)
-var rng := RandomNumberGenerator.new()
-
-var stocks := {} # clé: "water","food","wood","stone"
-var policies := {"military":0.2,"economy":0.5,"social":0.2,"environment":0.1}
-
-const TICK_LOCAL := 0.1   # 100 ms
-const TICK_WORLD := 1.0   # 1 s
-
-var _acc_local := 0.0
-var _acc_world := 0.0
-
-func _ready():
-    rng.randomize()
-    stocks = {"water":50.0,"food":50.0,"wood":30.0,"stone":15.0}
-
-func _process(delta):
-    if speed <= 0.0: return
-    var d := delta * speed
-    _acc_local += d
-    _acc_world += d
-    while _acc_local >= TICK_LOCAL:
-        _acc_local -= TICK_LOCAL
-        TickBus.emit_local_tick(TICK_LOCAL)
-    while _acc_world >= TICK_WORLD:
-        _acc_world -= TICK_WORLD
-        TickBus.emit_world_tick(TICK_WORLD)
+extends Node
+
+var speed: float = 1.0
+var rng: RandomNumberGenerator = RandomNumberGenerator.new()
+
+var stocks: Dictionary = {}
+var policies: Dictionary = {"military":0.2,"economy":0.5,"social":0.2,"environment":0.1}
+
+const TICK_LOCAL := 0.1
+const TICK_WORLD := 1.0
+
+var _acc_local: float = 0.0
+var _acc_world: float = 0.0
+
+func _ready() -> void:
+    rng.randomize()
+    stocks = {"water":50.0,"food":50.0,"wood":30.0,"stone":15.0}
+
+func _process(delta: float) -> void:
+    if speed <= 0.0:
+        return
+    var d: float = delta * speed
+    _acc_local += d
+    _acc_world += d
+    var bus = get_node("/root/TickBus")
+    while _acc_local >= TICK_LOCAL:
+        _acc_local -= TICK_LOCAL
+        bus.emit_local_tick(TICK_LOCAL)
+    while _acc_world >= TICK_WORLD:
+        _acc_world -= TICK_WORLD
+        bus.emit_world_tick(TICK_WORLD)
diff --git a/core/TickBus.gd b/core/TickBus.gd
--- a/core/TickBus.gd
+++ b/core/TickBus.gd
@@
-extends Node
-class_name TickBus
+extends Node
 signal local_tick(dt)
 signal world_tick(dt)
 
 func emit_local_tick(dt): emit_signal("local_tick", dt)
 func emit_world_tick(dt): emit_signal("world_tick", dt)
EOF

# 2) Appliquer et pousser
git apply fix_parse_errors.patch
git add core/Game.gd core/TickBus.gd
git commit -m "Fix parse errors (types + autoload calls)"
git push
